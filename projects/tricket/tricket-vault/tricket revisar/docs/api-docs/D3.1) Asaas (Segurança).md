---
id: 1MWW6F9VL0zK3nfg_XAuJBGf_edUvgHWQXyAHhifvWeA
status: 
version: 1
source: NotebookLM
type: task
action: create
space: Projetos
folder: Tricket
list: Marketplace
parent_id: 
created: 2025-07-08 09:09
due_date: ""
start_date: 
tags:
  - projetos/tricket
summary: 
path: /home/joaohenrique/Obsidian/01-PROJETOS/tricket-revisar
---



# Autentica√ß√£o

De que forma o Asaas identifica quem √© voc√™?

[Suggest Edits](https://docs.asaas.com/edit/autentica%C3%A7%C3%A3o-1)

A autentica√ß√£o em nossa API √© feita atrav√©s do uso de uma¬†**chave de API**. √â atrav√©s desta chave que nosso sistema identifica a sua conta e permite a comunica√ß√£o conosco em nome da conta em quest√£o.

Caso a chave de API seja inv√°lida, n√£o seja informada ou o header esteja incorreto, nossa API retornar√°¬†`HTTP 401`.

A seguran√ßa da chave de API √© de responsabilidade do cliente. Para refor√ßar sua seguran√ßa, recomendamos que voc√™ utilize tamb√©m os demais mecanismos de prote√ß√£o dispon√≠veis. Considere definir endere√ßos IP autorizados para adicionar uma camada extra de seguran√ßa. Para mais detalhes, consulte as medidas de seguran√ßa na documenta√ß√£o:¬†[Mecanismos adicionais de seguran√ßa](https://docs.asaas.com/docs/mecanismos-de-seguranca).

> ## üöß
> 
> **Aten√ß√£o:**
> 
> - Ap√≥s a gera√ß√£o da chave de API em nossa interface, armazene-a diretamente em seu cofre de chaves, evitando que seja exposta em mensagens de qualquer tipo ou emails.¬†**Nunca deixe a chave de API diretamente no c√≥digo fonte de seus sistemas.**
> - **N√£o informe sua chave de API em atendimentos, a terceiros ou exponha no front-end da sua aplica√ß√£o.**¬†Garanta que sua aplica√ß√£o n√£o exponha a chave em logs de sistema.
> - Caso seu time de desenvolvimento utilize a¬†**chave de API de Produ√ß√£o**¬†nos ambientes de desenvolvimento ou homologa√ß√£o durante os testes finais da integra√ß√£o, √© essencial renov√°-la antes da entrada em produ√ß√£o, garantindo que o menor n√∫mero de pessoas poss√≠vel tenha acesso a ela.
> - Utilize pelo menos um dos mecanismos adicionais de seguran√ßa¬†[descritos aqui](https://docs.asaas.com/docs/mecanismos-de-seguranca).
> - A chave de API √© irrecuper√°vel, caso seja perdida, √© necess√°rio a gera√ß√£o de uma nova.

### Utilize os headers abaixo em todas as suas chamadas para a API

[](https://docs.asaas.com/docs/autentica%C3%A7%C3%A3o-1#utilize-os-headers-abaixo-em-todas-as-suas-chamadas-para-a-api)

```JSON
{
"Content-Type": "application/json", 
"User-Agent": "nome_da_sua_aplica√ß√£o", 
"access_token": "sua_api_key"
}
```

> ## üöß
> 
> Importante
> 
> √â obrigat√≥rio enviar o¬†`User-Agent`¬†no header de todas as requisi√ß√µes em novas contas raiz criadas a partir de¬†**13/06/2024**. Sugerimos enviar o nome da sua aplica√ß√£o caso o seu framework n√£o adicione um User-Agent padr√£o.

> ## üìò
> 
> Ambientes distintos (Sandbox e Produ√ß√£o)
> 
> As Chaves de API s√£o distintas entre os ambientes de Sandbox e Produ√ß√£o, portanto lembre-se de alter√°-la quando mudar a URL.

> ## ‚ùóÔ∏è
> 
> ATEN√á√ÉO: Para testar os endpoints direto nesta documenta√ß√£o voc√™ precisa de uma chave de API de Sandbox
> 
> **Caso seja utilizada a chave de produ√ß√£o, obter√° o erro¬†[401 Unauthorized](https://docs.asaas.com/docs/erros-_comuns_-copy-1).**
> 
> Todos os endpoints da documenta√ß√£o apontam para nosso Sandbox, o ambiente de testes do Asaas. Antes de come√ßar voc√™ deve¬†[criar uma conta de testes](https://sandbox.asaas.com/onboarding/createAccount?customerSignUpOriginChannel=HOME)¬†e usar sua chave de API para testes.
> 
> [Saiba mais sobre o Sandbox](https://docs.asaas.com/docs/sandbox)

Para obter sua Chave de API¬†[acesse a √°rea de integra√ß√µes](https://www.asaas.com/customerApiAccessToken/index)¬†em nossa¬†**interface web**. Pelo aplicativo n√£o tem a op√ß√£o de gerar chave. Al√©m disso, apenas usu√°rios do tipo administrador, tem permiss√£o para gerar a chave.

![](https://files.readme.io/f4b7e1df6a46013c6702d8c5fa18485eb7751ca3b4f4781f6521641257838e77-image.png)

> ## üîí
> 
> Gerenciando suas chaves de API
> 
> - Voc√™ pode criar at√©¬†**10**¬†chaves de API para uma conta Asaas.
> - As chaves podem ser nomeadas, para facilitar a identifica√ß√£o.
> - √â poss√≠vel definir uma data de expira√ß√£o para cada chave.
> - Voc√™ pode desabilitar/habilitar uma chave a qualquer momento, sem de fato inv√°lida-la.
> - Caso a chave seja¬†**exclu√≠da**, n√£o √© poss√≠vel restaura-la.

## URL de Produ√ß√£o e Sandbox

[](https://docs.asaas.com/docs/autentica%C3%A7%C3%A3o-1#url-de-produ%C3%A7%C3%A3o-e-sandbox)

Ap√≥s a cria√ß√£o da conta e gera√ß√£o da chave de API, utilize a URL espec√≠fica para cada ambiente em suas chamadas, conforme listado abaixo:

|Ambiente|URL|
|---|---|
|Produ√ß√£o|[https://api.asaas.com/v3](https://api.asaas.com/v3)|
|Sandbox|[https://api-sandbox.asaas.com/v3](https://api-sandbox.asaas.com/v3)|

### Teste em ambiente Sandbox

[](https://docs.asaas.com/docs/autentica%C3%A7%C3%A3o-1#teste-em-ambiente-sandbox)

- Durante o desenvolvimento da integra√ß√£o, teste as requisi√ß√µes em nosso ambiente de Sandbox utilizando dados fict√≠cios e direcionando as requisi√ß√µes para o dom√≠nio ‚Äú[https://api-sandbox.asaas.com/v3](https://api-sandbox.asaas.com/v3)", alterando para produ√ß√£o apenas ap√≥s a valida√ß√£o de todas as funcionalidades.

# Armazenamento seguro para a Chave de API

[](https://docs.asaas.com/docs/autentica%C3%A7%C3%A3o-1#armazenamento-seguro-para-a-chave-de-api)

A¬†**Chave de API**¬†do Asaas segue o modelo de chave ‚Äúirrecuper√°vel‚Äù, isto √©, ela¬†**ser√° exibida apenas uma vez quando criada**. Sendo assim, voc√™ precisar√° copi√°-la e salv√°-la de modo seguro antes de sair da √°rea de integra√ß√µes.

- Nunca armazene chaves de API em texto claro dentro do c√≥digo-fonte ou em arquivos de configura√ß√£o acess√≠veis ao p√∫blico.
    
- Utilize mecanismos de seguran√ßa, como vari√°veis de ambiente ou arquivos de configura√ß√£o protegidos, para armazenar as chaves de API de forma segura.
    
- Utilize servi√ßos de gerenciamento de segredos para armazenar e gerenciar as chaves de API de forma centralizada e segura, como AWS Secrets Manager, Google Cloud Secret Manager e Azure Key Vault, por exemplo.
    

# Transmiss√£o segura da sua Chave de API

[](https://docs.asaas.com/docs/autentica%C3%A7%C3%A3o-1#transmiss%C3%A3o-segura-da-sua-chave-de-api)

- Utilize exclusivamente protocolos de comunica√ß√£o seguros, como HTTPS, evitando m√©todos n√£o criptografados, como HTTP.

## Protocolo de seguran√ßa TLS (Transport Layer Security)

[](https://docs.asaas.com/docs/autentica%C3%A7%C3%A3o-1#protocolo-de-seguran%C3%A7a-tls-transport-layer-security)

Atualmente nossos sistemas em produ√ß√£o aceitam TLS 1.2 e 1.3 para comunica√ß√£o. Mas recomendamos o uso do TLS 1.3.

# Controle de acesso e rota√ß√£o de chave

[](https://docs.asaas.com/docs/autentica%C3%A7%C3%A3o-1#controle-de-acesso-e-rota%C3%A7%C3%A3o-de-chave)

- O acesso √† Chave de API deve ser concedido apenas a usu√°rios ou sistemas autorizados que realmente necessitam de acesso aos recursos protegidos.
- Estabele√ßa um processo de monitoramento dos logs a fim de rastrear a origem e prop√≥sito das requisi√ß√µes, de modo a detectar atividades suspeitas ou uso indevido de sua Chave de API. Ferramentas como SIEM, Splunk, ELK Stack, AWS CloudWatch ou Azure Monitor podem auxiliar no processo.
- Estabele√ßa uma pol√≠tica de rota√ß√£o regular das chaves de API para reduzir o impacto em caso de comprometimento ou vazamento.
- O armazenamento e seguran√ßa da chave apikey √© de inteira responsabilidade do cliente, visto que o Asaas n√£o det√©m dessa informa√ß√£o armazenada em nenhum local de nosso banco.

---

# Mecanismos adicionais de seguran√ßa

Utilize os mecanismos abaixo para maior seguran√ßa em sua conta.

Al√©m de chave de API que √© usada para autenticar suas requisi√ß√µes, possu√≠mos mecanismos adicionais que oferecem camadas extras de seguran√ßa para sua conta. Recomendamos utilizar pelo menos um deles, e se poss√≠vel ambos. Conhe√ßa-os abaixo.

## Whitelist de IPs

[](https://docs.asaas.com/docs/mecanismos-de-seguranca#whitelist-de-ips)

Este mecanismo permite definir IPs a partir dos quais aceitaremos requisi√ß√µes utilizando sua chave de API.

Qualquer requisi√ß√£o recebida de um IP n√£o contido na whitelist ser√° recusada com resposta HTTP 403. Desta forma, mesmo que sua chave seja comprometida, a menos que as requisi√ß√µes partam de sua infraestrutura, elas ser√£o recusadas.

Voc√™ pode definir a sua lista de IPs autorizados acessando¬†[Menu do usu√°rio > Integra√ß√µes > Mecanismos de seguran√ßa](https://www.asaas.com/customerConfigIntegrations/apiAccessControl).

![](https://files.readme.io/c4671ff-image.png)

> ## üìò
> 
> Configura√ß√£o de IPs por faixa
> 
> Voc√™ consegue adicionar um IP autorizado em uma faixa de IPs, usando o¬†`x`, por exemplo:¬†`192.168.1.x`¬†ir√° pegar desde o IP¬†`192.168.1.0`¬†at√©¬†`192.168.1.255`.

### Por que fixar IPs?

[](https://docs.asaas.com/docs/mecanismos-de-seguranca#por-que-fixar-ips)

Fixar IPs para chamadas de API pode ser uma pr√°tica √∫til e necess√°ria por diversas raz√µes.

- **Restri√ß√£o de Acesso**: Ao fixar IPs, voc√™ pode restringir o acesso √†s suas APIs, permitindo chamadas apenas de IPs espec√≠ficos. Isso ajuda a bloquear acessos n√£o autorizados ou indesejados, como tentativas de invas√£o ou ataques DDoS.
- **Autentica√ß√£o e Filtragem de IP**: Muitas APIs e servi√ßos de backend permitem a configura√ß√£o de filtros de IP para garantir que apenas sistemas ou servidores conhecidos possam acessar a API. Esse tipo de controle aumenta a seguran√ßa do seu sistema.

Fixar IPs para chamadas de API √© uma pr√°tica que pode oferecer mais controle sobre seguran√ßa, desempenho, auditoria e conformidade regulat√≥ria. No entanto, isso tamb√©m exige a manuten√ß√£o de uma lista de IPs autorizados e pode tornar o gerenciamento de acessos mais complexo. A decis√£o de fixar ou n√£o os IPs depende muito do contexto de seguran√ßa e da infraestrutura da aplica√ß√£o ou servi√ßo.

## Webhook de autoriza√ß√£o de transfer√™ncias

[](https://docs.asaas.com/docs/mecanismos-de-seguranca#webhook-de-autoriza%C3%A7%C3%A3o-de-transfer%C3%AAncias)

Ao habilitar este mecanismo, todas as transfer√™ncias solicitadas em sua conta disparar√£o um webhook para o seu sistema afim de validar a legitimidade das mesmas. Desta forma, a menos que seu sistema reconhe√ßa a transfer√™ncia como leg√≠tima, ela ser√° cancelada. Para maiores detalhes no uso deste mecanismo acesso √†¬†[documenta√ß√£o](https://docs.asaas.com/docs/mecanismo-para-validacao-de-saque-via-webhooks).

---
# Mecanismo para valida√ß√£o de saque via webhooks

Uma forma de confirmar transfer√™ncias via um Webhook especial.

O Asaas est√° constantemente investindo em seguran√ßa, e tamb√©m criando m√©todos para tornar a sua opera√ß√£o conosco cada vez mais segura e confi√°vel.

Nessa documenta√ß√£o, voc√™ encontrar√° o detalhamento do m√©todo de valida√ß√£o de transfer√™ncias atrav√©s de Webhooks.

### Ativando mecanismo via interface

[](https://docs.asaas.com/docs/mecanismo-para-validacao-de-saque-via-webhooks#ativando-mecanismo-via-interface)

Para ativar o mecanismo na sua conta, acesse o¬†[Menu do usu√°rio > Integra√ß√µes > Mecanismos de seguran√ßa](https://www.asaas.com/apiAccessControl/index).

![](https://files.readme.io/1151556f343ba745635c3bb784c6623b8aeff4cd640a5c15abed19054445672f-image_1.png)

A configura√ß√£o √© bem simples, voc√™ precisa apenas adicionar qual ser√° a URL do seu Webhook, o e-mail para receber notifica√ß√µes de erros e o token de autentica√ß√£o, ele √© opcional, por√©m sugerimos sempre utilizar. Este token ser√° enviado no header¬†`asaas-access-token`¬†e voc√™ pode valid√°-lo para saber que se trata de uma requisi√ß√£o leg√≠tima do Asaas.

> ## üöß
> 
> Aten√ß√£o
> 
> Ao realizar a configura√ß√£o, todas as transfer√™ncias e saques realizados via API ser√£o tratadas por este mecanismo de seguran√ßa.

> ## üìò
> 
> Configura√ß√£o para estornos Pix
> 
> Para habilitar a configura√ß√£o de estornos Pix, marque a op√ß√£o "Ativar autoriza√ß√£o de saque para estornos Pix". Vale ressaltar que essa configura√ß√£o n√£o √© obrigat√≥ria para saques.

> ## üìò
> 
> Configura√ß√£o para subcontas
> 
> A configura√ß√£o √© feita automaticamente para todas as subcontas de acordo com a configura√ß√£o realizada na conta raiz, sejam elas white label ou n√£o.

Voc√™ tem a op√ß√£o de validar tamb√©m os saques via interface, dessa forma qualquer novo saque realizado na sua conta, seja via API ou via interface ir√° passar pelo fluxo de valida√ß√£o.

### Fluxo para autoriza√ß√£o de saques

[](https://docs.asaas.com/docs/mecanismo-para-validacao-de-saque-via-webhooks#fluxo-para-autoriza%C3%A7%C3%A3o-de-saques)

O fluxo de autoriza√ß√£o de saques funciona da seguinte forma:

![](https://files.readme.io/a5ee7a1-fluxo_de_autorizao_de_transferencias.png)

### Como o mecanismo funciona?

[](https://docs.asaas.com/docs/mecanismo-para-validacao-de-saque-via-webhooks#como-o-mecanismo-funciona)

- Voc√™ solicitar√° a transfer√™ncia via API e armazenar√° o ID ou mais dados do retorno em sua base de dados.
- O Asaas far√° um¬†`POST`¬†cinco segundos ap√≥s a cria√ß√£o da transfer√™ncia para a URL configurada com o payload da transfer√™ncia (os payloads sempre ser√£o os mesmos enviados no retorno da cria√ß√£o).
- Essa requisi√ß√£o pode falhar no m√°ximo tr√™s vezes, ap√≥s a terceira falha a transfer√™ncia ser√° cancelada automaticamente.
- Voc√™ deve verificar se o payload recebido bate com o que possui armazenado.
- Responder√° se aprova ou n√£o a transfer√™ncia.

### Exemplo de requisi√ß√£o que o Asaas ir√° realizar (Transfer√™ncia)

``` JSON
{
   "type":"TRANSFER",
   "transfer":{
      "object":"transfer",
      "id":"0bed986c-737d-49bf-a1cc-beca916797c4",
      "dateCreated":"2022-05-27",
      "status":"PENDING",
      "effectiveDate":null,
      "type":"BANK_ACCOUNT",
      "value":22,
      "netValue":22,
      "transferFee":0,
      "scheduleDate":"2022-05-27",
      "confirmedDate":null,
      "failReason":null,
      "bankAccount":{
         "bank":{
            "code":null,
            "ispb":"00000000",
            "name":null
         },
         "accountName":"ASAAS GESTAO FINANCEIRA S.A.",
         "ownerName":"ASAAS GESTAO FINANCEIRA S.A.",
         "cpfCnpj":"70609293000194",
         "agency":"4124",
         "agencyDigit":null,
         "account":"42142",
         "accountDigit":"1",
         "pixAddressKey":null
      },
      "transactionReceiptUrl":null,
      "operationType":"PIX",
      "description":null
   }
}
``` 

### Exemplo de requisi√ß√£o que o Asaas ir√° realizar (Pague Contas)

``` json
{
   "type":"BILL",
   "bill":{
      "object":"bill",
      "id":623471,
      "status":"PENDING",
      "value":20.0,
      "discount":0,
      "interest":0,
      "fine":0,
      "identificationField":"23793381286001234107143000012345890460000002000",
      "dueDate":"2024-01-01",
      "scheduleDate":"2024-01-01",
      "paymentDate":null,
      "fee":0,
      "description":null,
      "companyName":null,
      "transactionReceiptUrl":null,
      "canBeCancelled":true,
      "failReasons":null,
      "bankId":4,
      "awaitingCriticalActionAuthorization":false,
      "bank":{
         "object":"bank",
         "id":4,
         "code":"237",
         "name":"Bradesco"
      }
   }
}
```
### Exemplo de requisi√ß√£o que o Asaas ir√° realizar (Pagamento de QRCode)

``` JSON
{
   "type":"PIX_QR_CODE",
   "pixQrCode":{
      "id":"aa10c444-3f02-40e7-a248-2d00cff5a45d",
      "endToEndIdentifier":"E1954055020220714160403012347510",
      "finality":null,
      "value":2,
      "changeValue":null,
      "refundedValue":0,
      "effectiveDate":"2022-07-14 13:04:03",
      "scheduledDate":null,
      "status":"AWAITING_REQUEST",
      "type":"DEBIT",
      "originType":"STATIC_QRCODE",
      "conciliationIdentifier":null,
      "description":null,
      "transactionReceiptUrl":null,
      "refusalReason":null,
      "canBeCanceled":true,
      "originalTransaction":null,
      "externalAccount":{
         "ispb":18236120,
         "ispbName":"NU PAGAMENTOS S.A. - INSTITUI\u00c7\u00c3O DE PAGAMENTO",
         "name":"John Doe",
         "cpfCnpj":"***.123.456-**",
         "addressKey":"john.doe@teste.com",
         "addressKeyType":"EMAIL"
      },
      "qrCode":{
         "payer":null,
         "conciliationIdentifier":null,
         "originalValue":1.00,
         "dueDate":null,
         "interest":0,
         "fine":0,
         "discount":0,
         "expirationDate":null
      },
      "payment":null
   }
}
```

### Exemplo de requisi√ß√£o que o Asaas ir√° realizar (Recarga de telefone)

``` JSON
{
   "type":"MOBILE_PHONE_RECHARGE",
   "mobilePhoneRecharge":{
      "id":"d29f7fdb-4cf9-4524-a44e-d1f3fd9ec0d3",
      "value":20,
      "phoneNumber":"47999999999",
      "status":"PENDING",
      "canBeCancelled":true,
      "operatorName":"Claro"
   }
}
```

### Exemplo de requisi√ß√£o que o Asaas ir√° realizar (Estorno Pix)

``` JSON
{
  "type": "PIX_REFUND",
  "pixRefund": {
    "id": "06391ba9-cbf9-4926-8988-374ac5d71cae",
    "transferId": "f3956d6d-6dbb-4882-8146-9df82288d95b",
    "endToEndIdentifier": null,
    "finality": null,
    "value": 200,
    "changeValue": null,
    "refundedValue": 0,
    "dateCreated": "17/12/2024 15:27:42",
    "effectiveDate": "17/12/2024 15:27:42",
    "scheduledDate": null,
    "status": "AWAITING_REQUEST",
    "type": "CREDIT_REFUND",
    "originType": null,
    "conciliationIdentifier": null,
    "description": null,
    "transactionReceiptUrl": null,
    "chargedFeeValue": 0,
    "canBeRefunded": false,
    "refundDisabledReason": "O tipo desta transa√ß√£o n√£o permite que ela seja estornada.",
    "refusalReason": null,
    "canBeCanceled": false,
    "originalTransaction": {
      "id": "b9852968-7825-4458-b069-d266ce8455c9",
      "endToEndIdentifier": "6709a838-7422-4198-94ed-76166a70c595",
      "value": 1000,
      "effectiveDate": "17/12/2024 15:26:57"
    },
    "externalAccount": {
      "ispb": 19540550,
      "ispbName": "ASAAS GEST√ÉO FINANCEIRA INSTITUI√á√ÉO DE PAGAMENTO S.A.",
      "name": "John Doe",
      "agency": "0",
      "account": "0000000",
      "accountDigit": "0",
      "accountType": "CHECKING_ACCOUNT",
      "cpfCnpj": "***.138.240-**",
      "addressKey": null,
      "addressKeyType": null
    },
    "qrCode": null,
    "payment": "pay_e4xnd1cc04w2n33n",
    "addressKey": null,
    "addressKeyType": null,
    "externalReference": null
  }
}
```

# Como validar uma transfer√™ncia

[](https://docs.asaas.com/docs/mecanismo-para-validacao-de-saque-via-webhooks#como-validar-uma-transfer%C3%AAncia)

Ao receber o¬†`POST`, voc√™ precisar√° respond√™-lo informando se reconhece a transfer√™ncia como resposta do pr√≥prio¬†`POST`. Para isso √© necess√°rio que voc√™ retorne um payload com um status.

Os poss√≠veis status s√£o:

**`APPROVED`**

**`REFUSED`**

Tamb√©m √© poss√≠vel informar o motivo da recusa, retornando junto do payload o refuseReason, exemplo:

``` JSON
{ 
    "status": "REFUSED", 
    "refuseReason": "Transfer√™ncia n√£o encontrada no nosso banco" 
}
```

Caso a transfer√™ncia seja reconhecida e aprovada, √© preciso responder da seguinte forma:

``` JSON
{ "status": "APPROVED" }
```

Caso n√£o seja retornado nenhum dos dois status ou a requisi√ß√£o apresente falha por 3 vezes consecutivas, daremos a solicita√ß√£o como falha e¬†**a transfer√™ncia ser√° cancelada**.