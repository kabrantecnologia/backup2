import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue';
import autoprefixer from 'autoprefixer';
import path from 'path';
import fs from 'fs';
import handlebars from 'handlebars';
import { nodePolyfills } from 'vite-plugin-node-polyfills';

const pages = {"quarentena/tricket/pagina-dos-produtos":{"outputDir":"./quarentena/tricket/pagina-dos-produtos","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/quarentena/tricket/pagina-dos-produtos/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/quarentena/tricket/pagina-dos-produtos/"}]},"tricket/fornecedor/cadastro/ofertas":{"outputDir":"./tricket/fornecedor/cadastro/ofertas","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/tricket/fornecedor/cadastro/ofertas/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/tricket/fornecedor/cadastro/ofertas/"}]},"cadastro-de-perfil":{"outputDir":"./cadastro-de-perfil","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/cadastro-de-perfil/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/cadastro-de-perfil/"}]},"index":{"outputDir":"./","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/"}]},"quarentena/pagina-do-produto/:param":{"outputDir":"./quarentena/pagina-do-produto/:param","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/quarentena/pagina-do-produto/:param/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/quarentena/pagina-do-produto/:param/"}]},"nova-senha":{"outputDir":"./nova-senha","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/nova-senha/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/nova-senha/"}]},"recuperar-senha":{"outputDir":"./recuperar-senha","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/recuperar-senha/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/recuperar-senha/"}]},"cadastro":{"outputDir":"./cadastro","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/cadastro/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/cadastro/"}]},"tricket/admin/cadastros/usuarios":{"outputDir":"./tricket/admin/cadastros/usuarios","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/tricket/admin/cadastros/usuarios/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/tricket/admin/cadastros/usuarios/"}]},"compliance/denuncia/empresa/:param":{"outputDir":"./compliance/denuncia/empresa/:param","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/compliance/denuncia/empresa/:param/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/compliance/denuncia/empresa/:param/"}]},"quarentena/oferta-2":{"outputDir":"./quarentena/oferta-2","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/quarentena/oferta-2/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/quarentena/oferta-2/"}]},"tricket/marketplace":{"outputDir":"./tricket/marketplace","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/tricket/marketplace/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/tricket/marketplace/"}]},"compliance/admin/dashboard":{"outputDir":"./compliance/admin/dashboard","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/compliance/admin/dashboard/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/compliance/admin/dashboard/"}]},"verificar-celular":{"outputDir":"./verificar-celular","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/verificar-celular/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/verificar-celular/"}]},":param":{"outputDir":"./:param","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/:param/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/:param/"}]},"compliance/admin/empresas":{"outputDir":"./compliance/admin/empresas","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/compliance/admin/empresas/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/compliance/admin/empresas/"}]},"verificar-email/:param":{"outputDir":"./verificar-email/:param","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/verificar-email/:param/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/verificar-email/:param/"}]},"quarentena/admin/cadastros/categorias":{"outputDir":"./quarentena/admin/cadastros/categorias","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/quarentena/admin/cadastros/categorias/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/quarentena/admin/cadastros/categorias/"}]},"compliance/portal/empresa/:param":{"outputDir":"./compliance/portal/empresa/:param","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/compliance/portal/empresa/:param/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/compliance/portal/empresa/:param/"}]},"cadastro/status":{"outputDir":"./cadastro/status","lang":"pt","cacheVersion":8,"meta":[{"name":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"itemprop":"image","content":"/images/simbolo-template.svg?_wwcv=8"},{"name":"twitter:card","content":"summary"},{"name":"twitter:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:image","content":"/images/simbolo-template.svg?_wwcv=8"},{"property":"og:site_name","content":"Projeto Template"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/cadastro/status/"},{"rel":"alternate","hreflang":"pt","href":"https://8f065f02-e9f8-4493-9078-32a946e675a3.weweb-preview.io/cadastro/status/"}]}};

// Read the main HTML template
const template = fs.readFileSync(path.resolve(__dirname, 'template.html'), 'utf-8');
const compiledTemplate = handlebars.compile(template);

// Generate an HTML file for each page with its metadata
Object.values(pages).forEach(pageConfig => {
    // Compile the template with page metadata
    const html = compiledTemplate({
        title: pageConfig.title,
        lang: pageConfig.lang,
        meta: pageConfig.meta,
        scripts: {
            head: pageConfig.scripts.head,
            body: pageConfig.scripts.body,
        },
        alternateLinks: pageConfig.alternateLinks,
        cacheVersion: pageConfig.cacheVersion,
        baseTag: pageConfig.baseTag,
    });

    // Save output html for each page
    if (!fs.existsSync(pageConfig.outputDir)) {
        fs.mkdirSync(pageConfig.outputDir, { recursive: true });
    }
    fs.writeFileSync(`${pageConfig.outputDir}/index.html`, html);
});

const rollupOptionsInput = {};
for (const pageName in pages) {
    rollupOptionsInput[pageName] = path.resolve(__dirname, pages[pageName].outputDir, 'index.html');
}

export default defineConfig(() => {
    return {
        plugins: [nodePolyfills({ include: ['events', 'stream', 'string_decoder'] }), vue()],
        base: "/",
        resolve: {
            alias: {
                '@': path.resolve(__dirname, './src'),
            },
        },
        css: {
            preprocessorOptions: {
                scss: {
                    api: 'modern-compiler',
                },
            },
            postcss: {
                plugins: [autoprefixer],
            },
        },
        build: {
            chunkSizeWarningLimit: 10000,
            rollupOptions: {
                input: rollupOptionsInput,
                onwarn: (entry, next) => {
                    if (entry.loc?.file && /js$/.test(entry.loc.file) && /Use of eval in/.test(entry.message)) return;
                    return next(entry);
                },
                maxParallelFileOps: 900,
            },
        },
        logLevel: 'warn',
    };
});
